
{% extends "base.html" %}

{% block content %}
<style>
/* Stats page specific styling */
.stats-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.stats-header {
    background: var(--gradient-primary);
    color: white;
    padding: 40px;
    border-radius: 20px;
    text-align: center;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px var(--shadow);
    border: 2px solid var(--accent-secondary);
}

.stats-header h1 {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 15px;
    color: white !important;
}

.stats-header .cookies-count {
    font-size: 4rem;
    font-weight: 900;
    color: var(--accent-secondary);
    display: block;
    margin-bottom: 10px;
    text-shadow: 0 3px 6px rgba(0,0,0,0.3);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

.stat-card {
    background: var(--bg-secondary);
    border: 2px solid var(--accent-primary);
    padding: 30px;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 8px 25px var(--shadow);
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px var(--shadow);
    border-color: var(--accent-secondary);
}

.stat-card h3 {
    color: var(--text-primary);
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 15px;
}

.stat-value {
    font-size: 3rem;
    font-weight: 900;
    color: var(--accent-primary);
    display: block;
    margin-bottom: 5px;
}

.service-card {
    background: var(--bg-secondary);
    border: 2px solid var(--border-color);
    border-radius: 15px;
    padding: 25px;
    transition: all 0.3s ease;
    margin-bottom: 20px;
}

.service-card:hover {
    border-color: var(--accent-secondary);
    box-shadow: 0 8px 25px var(--shadow);
}

.service-card h3 {
    color: var(--accent-primary);
    font-size: 1.4rem;
    font-weight: 700;
    margin-bottom: 20px;
}

.service-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
}

.service-stat {
    text-align: center;
}

.service-stat-value {
    font-size: 1.8rem;
    font-weight: 800;
    display: block;
}

.service-stat-label {
    font-size: 0.9rem;
    color: var(--text-secondary);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.completions-value {
    color: var(--accent-primary);
}

.earned-value {
    color: var(--accent-secondary);
}

.reward-value {
    color: var(--text-primary);
}
</style>

<div class="stats-container">
    <div class="stats-header">
        <h1>üìä Your Statistics</h1>
        <span class="cookies-count">üç™ {{ user.cookies or 0 }}</span>
        <span style="font-size: 1.2rem; opacity: 0.9;">Total Cookies Earned</span>
    </div>

<div class="stats-grid">
        <div class="stat-card">
            <h3>‚úÖ Total Completions</h3>
            <span class="stat-value completions-value">{{ total_completions }}</span>
        </div>
        
        <div class="stat-card">
            <h3>üìà Average per Completion</h3>
            <span class="stat-value earned-value">{{ "%.1f"|format((user.cookies or 0) / total_completions if total_completions > 0 else 0) }}</span>
        </div>
        
        <div class="stat-card">
            <h3>üìÖ Member Since</h3>
            <span class="stat-value reward-value" style="font-size: 1.5rem;">{{ user.created[:10] if user.created else 'Unknown' }}</span>
        </div>
    </div>

    <div class="card" style="background: var(--bg-secondary); border: 2px solid var(--accent-primary); border-radius: 20px; padding: 30px;">
        <h2 style="color: var(--accent-primary); font-size: 2rem; font-weight: 800; margin-bottom: 25px; text-align: center;">üìà Service Breakdown</h2>
        
        {% for service, config in shorteners.items() %}
            {% set stats = service_stats.get(service, {'completions': 0, 'total_earned': 0}) %}
            <div class="service-card">
                <h3>{{ config.name }}</h3>
                <div class="service-stats">
                    <div class="service-stat">
                        <span class="service-stat-value completions-value">{{ stats.completions }}</span>
                        <span class="service-stat-label">Completions</span>
                    </div>
                    <div class="service-stat">
                        <span class="service-stat-value earned-value">üç™ {{ stats.total_earned }}</span>
                        <span class="service-stat-label">Total Earned</span>
                    </div>
                    <div class="service-stat">
                        <span class="service-stat-value reward-value">{{ config.reward }}</span>
                        <span class="service-stat-label">Per Completion</span>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<script>
function moment(date) {
    const d = new Date(date);
    return {
        format: function(format) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return d.toLocaleDateString('en-US', options);
        }
    };
}
</script>
{% endblock %}
